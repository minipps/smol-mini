<!DOCTYPE html>
<html lang="{{ .Site.Language | default "en-us" }}">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	{{ if .Params.noindex }}
	<meta name="robots" content="noindex" />
	{{ end }}
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="author" content="{{ if .Params.author }}{{ .Params.author }}{{ else }}{{ range .Site.Author }}{{ . }} {{ end }}{{ end }}">
	<meta name="description" content="{{ if .IsHome }}{{ .Site.Params.Description }}{{ else }}{{ if .Params.description }}{{ .Params.description }}{{ else }}{{ .Summary | plainify }}{{ end }}{{ end }}" />
	<meta name="keywords" content="{{ .Site.Params.keywords }}{{ if .Params.tags }}{{ range .Params.tags }}, {{ . }}{{ end }}{{ end }}" />
	<meta name="robots" content="noodp" />
	<meta name="theme-color" content="{{ .Site.Params.themeColor }}" />
	<meta http-equiv="content-language" content="{{ .Site.Language }}">
	<link rel="canonical" href="{{ .Permalink }}" />
	<link rel="stylesheet" href="{{ "css/style.css" | relURL }}">
	{{ range .Site.Params.customCSS -}}
		<link rel="stylesheet" href="{{ . | relURL }}?rnd={{ now.Unix }}">
	{{- end }}
	{{ with .OutputFormats.Get "RSS" -}}
		{{ printf `<link rel="%s" type="%s" href="%s" title="%s">` .Rel .MediaType.Type .RelPermalink $.Site.Title | safeHTML }}
	{{- end }}
	{{ if .IsPage }}
		<script type="application/ld+json">
		{
			"@context":"https://schema.org",
			"@type": "BlogPosting",
			"headline": {{ .Title }},
			"image": {{"favicon.ico" | relURL}},
			"url": {{ .Permalink }},
			"dateCreated": "{{ .PublishDate.Format "2006-01-02T15:04:05-07:00" }}",
			"datePublished": "{{ .PublishDate.Format "2006-01-02T15:04:05-07:00" }}",
			"dateModified": "{{ .PublishDate.Format "2006-01-02T15:04:05-07:00" }}",
			"inLanguage": "{{ .Site.Language }}",
			"isFamilyFriendly": "true",
			"copyrightYear": "{{ .PublishDate.Format "2006" }}",
			"copyrightHolder": "{{ .Site.Params.author.name }}",
			"accountablePerson": {
			"@type": "Person",
			"name": "{{ .Site.Params.author.namer }}",
			"url": {{ .Site.BaseURL }}
			},
			"author": {
			"@type": "Person",
			"name": "{{.Site.Params.author.name}}",
			"url": {{ .Site.BaseURL }}
			},
			"creator": {
			"@type": "Person",
			"name": "{{ .Site.Params.author.name }}",
			"url": {{ .Site.BaseURL }}
			},
			"publisher": {
			"@type": "Organization",
			"name": "{{ .Site.Params.author.name }}",
			"url": {{ .Site.BaseURL }},
			"logo": {
				"@type": "ImageObject",
				"url": {{"favicon.ico" | relURL}}
			}
			},
			"mainEntityOfPage": "True",
			"articleBody": {{ .Content | safeJS | htmlUnescape | plainify }}
		}
		</script>
		{{ end }}

		{{ if .IsHome }}
		<script type="application/ld+json">
		{
			"@context":"https://schema.org",
			"@type": "WebSite",
			"image": {{"favicon.ico" | relURL}},
			"url": {{ .Permalink }},
			"inLanguage": "{{ .Site.Language }}",
			"abstract": "{{ .Site.Params.Description }}",
			"isFamilyFriendly": "true",
			"copyrightHolder": "{{ .Site.Params.author.name }}",
			"accountablePerson": {
			"@type": "Person",
			"name": "{{ .Site.Params.author.name }}",
			"url": {{ .Site.BaseURL }}
			},
			"keywords": {{ .Site.Params }},
			"author": {
			"@type": "Person",
			"name": "{{ .Site.Params.author.name }}",
			"url": {{ .Site.BaseURL }}
			},
			"creator": {
			"@type": "Person",
			"name": "{{ .Site.Params.author.name }}",
			"url": {{ .Site.BaseURL }}
			},
			"publisher": {
			"@type": "Organization",
			"name": "{{ .Site.Params.author.name }}",
			"url": {{ .Site.BaseURL }},
			"logo": {
				"@type": "ImageObject",
				"url": {{"favicon.ico" | relURL}}
			}
			},
			"mainEntityOfPage": "True",
			"articleBody": {{ .Content | safeJS | htmlUnescape | plainify }}
		}
		</script>
	{{ end }}
</head>
<body>
	{{ partial "header" . }}
	{{ block "main" . }}{{ end }}
	{{ partial "footer" . }}
</body>
<script defer>
	/**
	 * Theming.
	 *
	 * Supports the preferred color scheme of the operation system as well as
	 * the theme choice of the user.
	 *
	 */
	const themeToggle = document.querySelector(".theme-toggle");
	const chosenTheme = window.localStorage && window.localStorage.getItem("theme");
	const chosenThemeIsDark = chosenTheme == "dark";
	const chosenThemeIsLight = chosenTheme == "light";

	// Detect the color scheme the operating system prefers.
	function detectOSColorTheme() {
	if (chosenThemeIsDark) {
		document.documentElement.setAttribute("data-theme", "dark");
	} else if (chosenThemeIsLight) {
		document.documentElement.setAttribute("data-theme", "light");
	} else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
		document.documentElement.setAttribute("data-theme", "dark");
	} else {
		document.documentElement.setAttribute("data-theme", "light");
	}
	}

	// Switch the theme.
	function switchTheme(e) {
	if (chosenThemeIsDark) {
		localStorage.setItem("theme", "light");
	} else if (chosenThemeIsLight) {
		localStorage.setItem("theme", "dark");
	} else {
		if (document.documentElement.getAttribute("data-theme") == "dark") {
		localStorage.setItem("theme", "light");
		} else {
		localStorage.setItem("theme", "dark");
		}
	}

	detectOSColorTheme();
	window.location.reload();
	}

	// Event listener
	if (themeToggle) {
	themeToggle.addEventListener("click", switchTheme, false);
	window
		.matchMedia("(prefers-color-scheme: dark)")
		.addEventListener("change", (e) => e.matches && detectOSColorTheme());
	window
		.matchMedia("(prefers-color-scheme: light)")
		.addEventListener("change", (e) => e.matches && detectOSColorTheme());

	detectOSColorTheme();
	} else {
	localStorage.removeItem("theme");
	}
</script>
</html>
